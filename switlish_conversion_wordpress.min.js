function getSwitlishCookie(cname) { var name = cname + "="; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return ""; }


function transactionComplete(dataLayerVar, sw_transaction) {
	
	console.log('sw_transaction ', sw_transaction)
	
	var product_tab = [];

	 for (var i = 0; i <  sw_transaction.products.length; i++) {
		 
		line_item = JSON.parse(sw_transaction.products[i]);
		 
		product_tab.push({
			'sku': line_item.product_id,
			'name': line_item.product_name,
			'category': line_item.product_category,
			'price': line_item.product_price,
			'quantity': parseInt(line_item.product_quantity),
			'currency': line_item.product_currency,
		});
	}
	

	dataLayerVar.push({
		'event' : 'switlishTransactionComplete',
		'transactionId': sw_transaction.id,
		'transactionTotal': parseFloat(sw_transaction.total),
		'transactionCurrency': sw_transaction.currency,
		'transactionShipping': parseFloat(sw_transaction.shipping_total),
		'transactionTax': parseFloat(sw_transaction.total_tax),
		'transactionAffiliation': getSwitlishCookie('affiliate_id'),
		'transactionProducts': product_tab,
	});
};

(function($){
$(document).ready(function() {

	window.dataLayer = window.dataLayer || [];

	transactionComplete(window.dataLayer, sw_transaction);
});
})(jQuery);
  
//# sourceMappingURL=switlish_conversion_wordpress.min.js
